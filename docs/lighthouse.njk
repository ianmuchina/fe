<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>Reports</title>
        <meta
            name="description"
            content="Lighthouse Results for Frontend Mentor Challenges">
        <link rel="stylesheet" href="styles.css"/>
    </head>
    <body>
        <main>

        
        {% for l in lighthouse %}
            <div class="r">
                <header class="dim">
                    <span>
                        # {{ l.url.slice(1).replace("/index.html", "") }}
                    </span>
                    <span
                        class="pass">
                        {# if all checks are at 100 #}
                        {% if 
                            l.summary.performance ===1 and
                            l.summary.accessibility ==1 and
                            l.summary["best-practices"] ==1 and
                            l.summary.seo ==1 %}
                            ⭐
                        {% endif %}
                    </span>
                </header>
                <br/>
                {% macro icon(score) %}
                    {% if score >= 90 %}
                        <span class="green">●</span>
                    {% elif score >=50 %}
                        <span class="orange">■</span>
                    {% else %}
                        <span class="red">▲</span>
                    {% endif %}
                {% endmacro %}
                <!-- Performance -->
                <div>
                    {{ icon(l.summary.performance * 100) }} Performance:
                    <span>{{ l.summary.performance * 100 }}</span>
                </div>
                <!-- Accesibility -->
                <div>
                    {{ icon(l.summary.accessibility * 100) }} Accesibility:
                    <span>{{ l.summary.accessibility * 100 }}</span>
                </div>
                <!-- Best Practice -->
                <div>
                    {{ icon(l.summary["best-practices"] * 100) }} Best Practice:
                    <span>{{ l.summary["best-practices"] * 100 }}</span>
                </div>
                <!-- SEO -->
                <div>
                    {{ icon(l.summary.seo * 100) }} SEO:
                    <span>{{ l.summary.seo * 100 }}</span>
                </div>
                <br/> <br/>
                <div
                    class="link"
                    data-href='/.lhci/{{ l.htmlPath.split("lhci")[1] }}'
                    target="_blank"
                    rel="noopener noreferrer">
                    Full Report ↗
                </div>
            </div>
        {% endfor %}
    </main>
    <iframe id="lhci" src="" frameborder="1"></iframe>
    </body>
    <script>
        let links = document.querySelectorAll(".link")
        let lhci = document.querySelector("#lhci")
        
        links.forEach(l => l.addEventListener("click", e => {
            console.log(e.target.dataset.href)
            lhci.src = e.target.dataset.href
        }))
    </script>
</html>